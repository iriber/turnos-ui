<!-- BEGIN:main -->
<script language="javascript"
	src="{WEB_PATH}js/autocomplete/simpleAutoComplete.js"></script>
<link rel="stylesheet"
	href="{WEB_PATH}css/autocomplete/simpleAutoComplete.css"
	type="text/css" />
	
<style>

#editar{
	width: 100%;
}

#historia_clinica_left th{
	text-align: left;
}
</style>
<script type="text/javascript">

function cliente_historia_change(attrs){

	event = new Event("HistoriClinicaPage", attrs, "Cliente");
	subject.notify(event);

}

function turnoChange(event){
	//si finaliza un turno, retornamos a la agenda de turnos
	if( event.type == "TurnoFinalizado"){

		gotoLink( '{linkTurnosHome}' );
		
	}
}
function historia_mostrar_infoPersonal(event){

	if( event.type == "Cliente" ){
		cliente = event.data;
		
		$("#obraSocial").html("");
		$("#nroObraSocial").html("");
		$("#fechaNacimiento").html("");
		$("#fechaAlta").html("");
		$("#nroHistoriaClinica").html("");
		$("#edad").html("");
		
		if( cliente != null ){
	
	
			$("#fechaNacimiento").html(cliente["fechaNacimientoFormateada"]);
			$("#fechaAlta").html(cliente["fechaAltaFormateada"]);
	
			$("#nroHistoriaClinica").html(cliente["nroHistoriaClinica"]);
			$("#edad").html(cliente["edad"]);
			
			//info de obra social		
			var osOid = cliente["obraSocial.oid"];
			var osNombre = cliente["obraSocial.nombre"];
			var osNro = cliente["nroObraSocial"];
			if( osNombre != undefined ){		
				$("#obraSocial").html(osNombre);
			}
			if( osNro != undefined ){		
				$("#nroObraSocial").html(osNro);
			}
		}
	}	
}



function actualizarHistoria(){
	
	//$("#findentity_cliente_inputCode").blur();
}

$(document).ready(function(){
	
	//actualizarHistoria();
});


$(document).ready(function(){

	//escuchamos cambios en el cliente.
	observer = new Observer("hc_infopersonal", historia_mostrar_infoPersonal);
	subject.addObserver( observer );

	//escuchamos cambios en el turno
	observer = new Observer("hc_turnochange", turnoChange);
	subject.addObserver( observer );


	
	$('#cliente_ver_mas_datos').click(function() {
		
		$('#mas_datos_personales').toggle( 5, 'linear', function() {

			if ($("#cliente_ver_mas_datos").html() == "{ver_mas_datos_label}" ){
				$("#cliente_ver_mas_datos").html("{ver_menos_datos_label}");
			}else{
				$("#cliente_ver_mas_datos").html("{ver_mas_datos_label}");
			}
			
		});
	});
});


</script>
<div id="historia_clinica">
	
	<div id="historia_clinica_left" class="turnos_form" >
		<fieldset>
			<legend>{cliente_info_subtitle}</legend>
			
	   		<table>
				<tr>
					<th>{cliente_label}</th>
				</tr>
				<tr>
					<td><span id="nombre">{cliente}</span> (<span id="edad">{edad}</span>)</td>
				</tr>
				<tr>
					<th>{obraSocial_label}</th>
				</tr>
				<tr>
					<td><span id="obraSocial">{obraSocial}</span> / <span id="nroObraSocial">{nroObraSocial}</span></td>
				</tr>
			</table>
			
			<table id="mas_datos_personales" style="display:none;">
				<tr>
					<th>{domicilio_label}</th>
				</tr>
				<tr>
					<td><span id="domicilio">{domicilio}</span> / <span id="localidad">{localidad}</span></td>
				</tr>
				
				<tr>
					<th>{documento_label}</th>
				</tr>
				<tr>
					<td><span id="tipoDocumento">{tipoDocumento}</span> <span id="nroDocumento">{nroDocumento}</span></td>
					
				</tr>
				<tr>
					<th>{fechaAlta_label}</th>
				</tr>
				<tr>
					<td><span id="fechaAlta">{fechaAlta}</span></td>
					
				</tr>
				<tr>
					<th>{fechaNacimiento_label}</th>
				</tr>
				<tr>
					<td><span id="fechaNacimiento">{fechaNacimiento}</span></td>
				</tr>
				<tr>
					<th>{telefonos_label}</th>
				</tr>
				<tr>
					<td><span id="telefonoFijo">{telefonoFijo}</span> / <span id="telefonoMovil">{telefonoMovil}</span></td>
				</tr>
				<tr>
					<th>{email_label}</th>
				</tr>
				<tr>
					<td><span id="email">{email}</span></td>					
				</tr>
				
			</table>			
			
			<span style="cursor: pointer;" id="cliente_ver_mas_datos">{ver_mas_datos_label}</span>
			
		</fieldset>	
		<fieldset>
			<legend>{historia_info_subtitle} - <span id="nroHistoriaClinica">{nroHistoriaClinica}</span></legend>
			
			<rasty id="historia" />
			
		</fieldset>
	</div>
	<div id="historia_clinica_right">
		<fieldset>
			<legend>{turnos_info_subtitle}</legend>
			<rasty id="turnosCliente" />	
		</fieldset>
		<fieldset style="display:none;">
			<legend>{resumenes_info_subtitle}</legend>
			<div id="historia_resumenes_hc"></div>	
		</fieldset>
	</div>	
</div>

<!-- END:main -->